generator client {
  provider = "prisma-client-js"
  output   = "../generated/client"
}

generator zod {
  provider         = "zod-prisma-types"
  output           = "../generated/zod"
  prismaClientPath = "../client"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model CacheEntry {
  key       String   @id @db.VarChar(512)
  value     String   @db.LongText
  updatedAt DateTime @updatedAt
}

model Repository {
  id          String @id @db.VarChar(100) /// z.string().regex(/^.*\/.*$/)
  owner       String @db.VarChar(100)
  name        String @db.VarChar(100)
  description String @db.VarChar(500)
  readme      String @db.VarChar(2000)
  language    String @db.VarChar(100)

  url       String  @db.VarChar(256) /// z.string().url()
  numStars  Int /// z.number().int().positive()
  numIssues Int /// z.number().int().positive()
  topics    Topic[]

  updatedAt DateTime @default(now()) @updatedAt
}

model Topic {
  name         String       @id @db.VarChar(100)
  updatedAt    DateTime     @default(now()) @updatedAt
  repositories Repository[]
}
